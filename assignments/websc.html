<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pelin Ergöz">
<meta name="dcterms.date" content="2024-12-29">

<title>Film Analysis Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="websc_files/libs/clipboard/clipboard.min.js"></script>
<script src="websc_files/libs/quarto-html/quarto.js"></script>
<script src="websc_files/libs/quarto-html/popper.min.js"></script>
<script src="websc_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="websc_files/libs/quarto-html/anchor.min.js"></script>
<link href="websc_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="websc_files/libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="websc_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="websc_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="websc_files/libs/bootstrap/bootstrap-92c47ccb3ade77dcee1b3b27e46720af.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="websc_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="websc_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="websc_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="websc_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="websc_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="websc_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="websc_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="websc_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="websc_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#a.-arrange-your-data-frame-in-descending-order-by-rating.-present-the-top-5-and-bottom-5-movies-based-on-user-ratings.-have-you-watched-any-of-these-movies-do-you-agree-or-disagree-with-their-current-imdb-ratings" id="toc-a.-arrange-your-data-frame-in-descending-order-by-rating.-present-the-top-5-and-bottom-5-movies-based-on-user-ratings.-have-you-watched-any-of-these-movies-do-you-agree-or-disagree-with-their-current-imdb-ratings" class="nav-link active" data-scroll-target="#a.-arrange-your-data-frame-in-descending-order-by-rating.-present-the-top-5-and-bottom-5-movies-based-on-user-ratings.-have-you-watched-any-of-these-movies-do-you-agree-or-disagree-with-their-current-imdb-ratings"><span class="header-section-number">1</span> a. Arrange your data frame in descending order by Rating. Present the top 5 and bottom 5 movies based on user ratings. Have you watched any of these movies? Do you agree or disagree with their current IMDb Ratings?</a></li>
  <li><a href="#b.-check-the-ratings-of-2-3-of-your-favorite-movies.-what-are-their-standings" id="toc-b.-check-the-ratings-of-2-3-of-your-favorite-movies.-what-are-their-standings" class="nav-link" data-scroll-target="#b.-check-the-ratings-of-2-3-of-your-favorite-movies.-what-are-their-standings"><span class="header-section-number">2</span> b. Check the ratings of 2-3 of your favorite movies. What are their standings?</a></li>
  <li><a href="#c.-considering-that-audience-rating-is-a-crucial-indicator-of-movie-quality-what-can-you-infer-about-the-average-ratings-of-turkish-movies-over-the-years-calculate-yearly-rating-averages-and-plot-them-as-a-scatter-plot." id="toc-c.-considering-that-audience-rating-is-a-crucial-indicator-of-movie-quality-what-can-you-infer-about-the-average-ratings-of-turkish-movies-over-the-years-calculate-yearly-rating-averages-and-plot-them-as-a-scatter-plot." class="nav-link" data-scroll-target="#c.-considering-that-audience-rating-is-a-crucial-indicator-of-movie-quality-what-can-you-infer-about-the-average-ratings-of-turkish-movies-over-the-years-calculate-yearly-rating-averages-and-plot-them-as-a-scatter-plot."><span class="header-section-number">3</span> c.&nbsp;Considering that audience rating is a crucial indicator of movie quality, what can you infer about the average ratings of Turkish movies over the years? Calculate yearly rating averages and plot them as a scatter plot.</a></li>
  <li><a href="#d.-do-you-believe-there-is-a-relationship-between-the-number-of-votes-a-movie-received-and-its-rating-investigate-the-correlation-between-votes-and-ratings." id="toc-d.-do-you-believe-there-is-a-relationship-between-the-number-of-votes-a-movie-received-and-its-rating-investigate-the-correlation-between-votes-and-ratings." class="nav-link" data-scroll-target="#d.-do-you-believe-there-is-a-relationship-between-the-number-of-votes-a-movie-received-and-its-rating-investigate-the-correlation-between-votes-and-ratings."><span class="header-section-number">4</span> d.&nbsp;Do you believe there is a relationship between the number of votes a movie received and its rating? Investigate the correlation between Votes and Ratings.</a></li>
  <li><a href="#e.-do-you-believe-there-is-a-relationship-between-a-movies-duration-and-its-rating-investigate-the-correlation-between-duration-and-ratings." id="toc-e.-do-you-believe-there-is-a-relationship-between-a-movies-duration-and-its-rating-investigate-the-correlation-between-duration-and-ratings." class="nav-link" data-scroll-target="#e.-do-you-believe-there-is-a-relationship-between-a-movies-duration-and-its-rating-investigate-the-correlation-between-duration-and-ratings."><span class="header-section-number">5</span> e. Do you believe there is a relationship between a movie’s duration and its rating? Investigate the correlation between Duration and Ratings.</a></li>
  <li><a href="#repeat-steps-1-and-2-for-a-different-advanced-imdb-search.-this-time-find-turkish-movies-that-are-in-the-top-1000-movies-on-imdb.-perform-similar-scraping-to-create-another-dataframe-with-only-the-columns-title-year." id="toc-repeat-steps-1-and-2-for-a-different-advanced-imdb-search.-this-time-find-turkish-movies-that-are-in-the-top-1000-movies-on-imdb.-perform-similar-scraping-to-create-another-dataframe-with-only-the-columns-title-year." class="nav-link" data-scroll-target="#repeat-steps-1-and-2-for-a-different-advanced-imdb-search.-this-time-find-turkish-movies-that-are-in-the-top-1000-movies-on-imdb.-perform-similar-scraping-to-create-another-dataframe-with-only-the-columns-title-year."><span class="header-section-number">6</span> 4. Repeat steps 1 and 2 for a different advanced IMDb search. This time, find Turkish movies that are in the top 1000 movies on IMDb. Perform similar scraping to create another DataFrame with only the columns: Title, Year.</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Film Analysis Report</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pelin Ergöz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 29, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSelenium)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://m.imdb.com/search/title/?title_type=feature&amp;release_date=2010-01-01,2023-12-31&amp;num_votes=2500,&amp;country_of_origin=TR&amp;count=250"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://m.imdb.com/search/title/?title_type=feature&amp;release_date=,2009-12-31&amp;num_votes=2500,&amp;country_of_origin=TR&amp;count=250"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>rD <span class="ot">&lt;-</span> <span class="fu">rsDriver</span>(<span class="at">browser =</span> <span class="st">"firefox"</span>, <span class="at">port =</span> <span class="dv">4545</span>L, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>remDr <span class="ot">&lt;-</span> rD[[<span class="st">"client"</span>]]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>all_movies <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (url <span class="cf">in</span> urls) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  remDr<span class="sc">$</span><span class="fu">navigate</span>(url)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">5</span>) </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  page_source <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">getPageSource</span>()[[<span class="dv">1</span>]]</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(page_source)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  title_names <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">"h3.ipc-title__text"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="st">" "</span>, <span class="at">n =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>             </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="cf">function</span>(x) x[<span class="dv">2</span>]) <span class="sc">%&gt;%</span>          </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()                              </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  years <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".sc-300a8231-6.dBUjvq.dli-title-metadata span:nth-child(1)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  duraction <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".sc-300a8231-6.dBUjvq.dli-title-metadata span:nth-child(2)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  rating <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">"span.ipc-rating-star--rating"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  votes <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">"span.ipc-rating-star--voteCount"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  duraction_minutes <span class="ot">&lt;-</span> duraction <span class="sc">%&gt;%</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="cf">function</span>(x) {</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">str_detect</span>(x, <span class="st">"h"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(x, <span class="st">"m"</span>)) { </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        parts <span class="ot">&lt;-</span> <span class="fu">str_split</span>(x, <span class="st">"h "</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(parts[<span class="dv">1</span>]) <span class="sc">*</span> <span class="dv">60</span> <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace</span>(parts[<span class="dv">2</span>], <span class="st">"m"</span>, <span class="st">""</span>))</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">str_detect</span>(x, <span class="st">"h"</span>)) {</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">str_replace</span>(x, <span class="st">"h"</span>, <span class="st">""</span>)) <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">str_detect</span>(x, <span class="st">"m"</span>)) { </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">str_replace</span>(x, <span class="st">"m"</span>, <span class="st">""</span>))</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NA</span> </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">%&gt;%</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>()</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  votes_numeric <span class="ot">&lt;-</span> votes <span class="sc">%&gt;%</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"[()K]"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>() <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  movie_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">Title =</span> title_names,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> years,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">Duration =</span> duraction_minutes,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rating =</span> <span class="fu">as.numeric</span>(rating),</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">Votes =</span> votes_numeric,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  all_movies <span class="ot">&lt;-</span> <span class="fu">append</span>(all_movies, <span class="fu">list</span>(movie_data))</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>final_movie_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_movies)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_movie_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                Title Year Duration Rating Votes
1   Kuru Otlar Üstüne 2023      197    7.7 16000
2 7. Koğuştaki Mucize 2019      132    8.2 58000
3   Cebimdeki Yabancı 2018       95    6.8 10000
4              Abluka 2015      119    7.2  4500
5          Kış Uykusu 2014      196    8.0 57000
6                Ayla 2017      125    8.2 45000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">close</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>rD<span class="sc">$</span>server<span class="sc">$</span><span class="fu">stop</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>It was decided to pull the data using Rselenium. With the rvest I encountered, I decided to pull with r selenium when I pulled only 25 due to the dynamic loading of the imdb site that takes it statically. By looking at the necessary html tags through the console, the necessary information about the movies was successfully pulled. After that, duration, votes conversions were made ready for the data to be converted to the desired format. When I fulfill the necessary conditions when pulling the data, 482 lines come out, and when I apply the necessary filters from the website and look at it, I find this.</p>
<section id="a.-arrange-your-data-frame-in-descending-order-by-rating.-present-the-top-5-and-bottom-5-movies-based-on-user-ratings.-have-you-watched-any-of-these-movies-do-you-agree-or-disagree-with-their-current-imdb-ratings" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> a. Arrange your data frame in descending order by Rating. Present the top 5 and bottom 5 movies based on user ratings. Have you watched any of these movies? Do you agree or disagree with their current IMDb Ratings?</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>sorted_movies <span class="ot">&lt;-</span> final_movie_data <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Rating)) <span class="co"># </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>top_5_movies <span class="ot">&lt;-</span> <span class="fu">head</span>(sorted_movies, <span class="dv">5</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>bottom_5_movies <span class="ot">&lt;-</span> <span class="fu">tail</span>(sorted_movies, <span class="dv">5</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top 5 Movies:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 Movies:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_5_movies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         Title Year Duration Rating Votes
1               Hababam Sınıfı 1975       85    9.2 44000
2                   Tosun Paşa 1976       90    8.9 25000
3                Süt Kardeşler 1976       80    8.8 22000
4 Hababam Sınıfı Sınıfta Kaldı 1975       95    8.8 25000
5             Şaban Oğlu Şaban 1977       90    8.7 19000</code></pre>
</div>
</div>
<p>When I looked at the first 5 movies, these are the ones I watched. They are ‘Yeşil Çam’ classics and each of them starred Kemal Sunal, whose old work can still be seen today. But you also have to look at this. There were more universal works coming out in different parts of the world at this time.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Bottom 5 Movies:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Bottom 5 Movies:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bottom_5_movies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             Title Year Duration Rating Votes
478                 Cumali Ceber 2 2018      100    1.2 10000
479              15/07 Şafak Vakti 2021       95    1.2 21000
480                          Müjde 2022       48    1.2 10000
481                           Reis 2017      108    1.0 74000
482 Cumali Ceber: Allah Seni Alsın 2017      100    1.0 39000</code></pre>
</div>
</div>
<p>I haven’t seen these movies. They’re close to the present.</p>
</section>
<section id="b.-check-the-ratings-of-2-3-of-your-favorite-movies.-what-are-their-standings" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> b. Check the ratings of 2-3 of your favorite movies. What are their standings?</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>favorite_movies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Babam ve Oğlum"</span>, <span class="st">"Kaybedenler Kulübü"</span>, <span class="st">"Sonbahar"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>favorite_movie_data <span class="ot">&lt;-</span> final_movie_data <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">%in%</span> favorite_movies) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Rating))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ratings and Rankings of Your Favorite Movies:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ratings and Rankings of Your Favorite Movies:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(favorite_movie_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Title Year Duration Rating Votes
1     Babam ve Oğlum 2005      108    8.2 96000
2           Sonbahar 2008       99    7.7  7100
3 Kaybedenler Kulübü 2011      105    7.4 26000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>final_movie_data <span class="ot">&lt;-</span> final_movie_data <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rank =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I chose 3 of my favorite movies, then I ranked them according to their rating values. Then I decided to create a column that keeps these rankings within the rank framework. as well as a column that keeps their order in my ranking according to time or something else.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rankings of your favorite movies</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>favorite_movie_rankings <span class="ot">&lt;-</span> final_movie_data <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">%in%</span> favorite_movies)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Overall Rankings of Your Favorite Movies:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Overall Rankings of Your Favorite Movies:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(favorite_movie_rankings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Title Year Duration Rating Votes Rank
1     Babam ve Oğlum 2005      108    8.2 96000   27
2           Sonbahar 2008       99    7.7  7100   71
3 Kaybedenler Kulübü 2011      105    7.4 26000  119</code></pre>
</div>
</div>
<p>It can now be seen where it stands in the overall ranking.</p>
</section>
<section id="c.-considering-that-audience-rating-is-a-crucial-indicator-of-movie-quality-what-can-you-infer-about-the-average-ratings-of-turkish-movies-over-the-years-calculate-yearly-rating-averages-and-plot-them-as-a-scatter-plot." class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> c.&nbsp;Considering that audience rating is a crucial indicator of movie quality, what can you infer about the average ratings of Turkish movies over the years? Calculate yearly rating averages and plot them as a scatter plot.</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>yearly_avg_ratings <span class="ot">&lt;-</span> final_movie_data <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Film_Count =</span> <span class="fu">n</span>(),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Average_Rating =</span> <span class="fu">mean</span>(Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  yearly_avg_ratings,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Year),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Average_Rating,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'#4CAF50'</span>, <span class="at">width =</span> <span class="dv">3</span>), </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'#8BC34A'</span>, <span class="at">size =</span> <span class="dv">10</span>) </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Yearly Average Ratings"</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>, <span class="at">tickangle =</span> <span class="dv">300</span>),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Average Rating"</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_bgcolor =</span> <span class="st">'rgba(245,245,245,1)'</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>fig1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-bb265b514c044068b4ce" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bb265b514c044068b4ce">{"x":{"visdat":{"2e20532ad594":["function () ","plotlyVisDat"]},"cur_data":"2e20532ad594","attrs":{"2e20532ad594":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"#4CAF50","width":3},"marker":{"color":"#8BC34A","size":10},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Yearly Average Ratings","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","tickangle":300},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Rating"},"plot_bgcolor":"rgba(245,245,245,1)","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1963,1965,1966,1968,1970,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023],"y":[7.7999999999999998,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.0999999999999996,7.5250000000000004,7.8250000000000002,7.7142857142857144,8.2142857142857153,8.1142857142857139,7.6399999999999997,7.4142857142857146,7.5,7.2000000000000002,6.8499999999999996,7.3499999999999996,7.1333333333333329,6.9857142857142858,7.1799999999999997,7.2857142857142856,7,7.7666666666666666,7.3499999999999996,6.5999999999999996,7.7999999999999998,7.7000000000000002,6.0999999999999996,7.5666666666666664,7.5666666666666664,8,7,6.54,6.7800000000000002,7.5,6.2000000000000002,6.2444444444444445,6.3399999999999999,5.4500000000000002,5.5916666666666668,6.2454545454545451,6.415,6.0625,6.4666666666666668,6.2166666666666668,6.4500000000000002,6.2999999999999998,6.0875000000000004,5.8875000000000002,5.2555555555555555,5.6916666666666664,5.9823529411764707,5.5999999999999996,5.8700000000000001,5.8600000000000003,5.8533333333333335],"mode":"lines+markers","line":{"color":"#4CAF50","width":3},"marker":{"color":"#8BC34A","size":10,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Overall, there has been a marked decline in average ratings, especially after the 2000s. While earlier periods, such as the 1960s and 1970s, had higher and more stable ratings, this has changed in recent years and ratings have fallen to lower levels.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  yearly_avg_ratings,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Year),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Film_Count,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'bar'</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'#FF5722'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'#E64A19'</span>, <span class="at">width =</span> <span class="fl">1.5</span>))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Films by Year"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>, <span class="at">tickangle =</span> <span class="dv">300</span>),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Film Count"</span>),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_bgcolor =</span> <span class="st">'rgba(245,245,245,1)'</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>fig2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-4f908a31d3a3a66f8abf" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4f908a31d3a3a66f8abf">{"x":{"visdat":{"2e203271f22f":["function () ","plotlyVisDat"]},"cur_data":"2e203271f22f","attrs":{"2e203271f22f":{"x":{},"y":{},"marker":{"color":"#FF5722","line":{"color":"#E64A19","width":1.5}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Films by Year","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","tickangle":300},"yaxis":{"domain":[0,1],"automargin":true,"title":"Film Count"},"plot_bgcolor":"rgba(245,245,245,1)","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1963,1965,1966,1968,1970,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023],"y":[1,1,1,1,1,1,4,4,7,7,7,10,7,4,5,4,8,6,7,5,7,3,3,4,1,1,1,1,3,3,2,6,5,5,1,4,9,10,18,12,22,20,16,18,12,16,22,24,24,27,24,17,10,10,15,15],"marker":{"color":"#FF5722","line":{"color":"#E64A19","width":1.5}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This graph shows the number of movies produced by year. Looking at the graph, I noticed a significant increase in film production, especially after the 2000s. Film production, which was quite low before the 1970s, seems to have picked up a bit in the 1980s. However, production stagnated in the 1990s and even decreased in some years. Since the 2000s, there has been a steady and rapid increase in the number of films, which peaked in the 2010s. After 2010, there are years when the annual number of movies exceeds 25. However, there is also a decline in the number of movies in the 2020s, which represents a pandemic-induced decline.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  final_movie_data,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>Year,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Rating,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'box'</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">boxpoints =</span> <span class="st">'all'</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">jitter =</span> <span class="fl">0.3</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointpos =</span> <span class="sc">-</span><span class="fl">1.8</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'#03A9F4'</span>, <span class="at">opacity =</span> <span class="fl">0.6</span>),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fillcolor =</span> <span class="st">'#B3E5FC'</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Yearly Rating Distributions"</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>, <span class="at">tickangle =</span> <span class="dv">300</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Rating"</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_bgcolor =</span> <span class="st">'rgba(245,245,245,1)'</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>fig3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ec45eddaf5091b1473b2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ec45eddaf5091b1473b2">{"x":{"visdat":{"2e203704b681":["function () ","plotlyVisDat"]},"cur_data":"2e203704b681","attrs":{"2e203704b681":{"x":{},"y":{},"boxpoints":"all","jitter":0.29999999999999999,"pointpos":-1.8,"marker":{"color":"#03A9F4","opacity":0.59999999999999998},"fillcolor":"#B3E5FC","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Yearly Rating Distributions","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","tickangle":300,"type":"category","categoryorder":"array","categoryarray":["1963","1965","1966","1968","1970","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Rating"},"plot_bgcolor":"rgba(245,245,245,1)","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"#B3E5FC","x":["1975","1976","1976","1975","1977","1978","1978","1976","1973","1985","1977","1977","1977","1980","1987","1977","1975","2016","1989","1976","1974","2019","2017","2016","2018","2019","2005","1996","1997","2005","1998","1978","1979","1984","1981","2014","2018","2011","2004","2009","2001","1989","1977","1982","1976","2015","2022","1982","1998","1965","1968","1983","1990","1983","2008","1966","1970","1974","2011","2010","2007","1963","1986","1992","2005","1974","2023","2014","2013","2006","2008","1993","1983","2004","1978","1981","1987","2016","2013","2015","2017","2018","2018","2017","1997","1996","2004","1990","1980","1983","1984","1975","1976","1979","2022","2012","2014","2013","2011","2012","2014","2002","2009","2001","2006","1987","2004","1999","1978","1987","1979","2007","1978","1985","2004","1979","2010","2015","2011","2019","2013","2010","2018","2008","2009","2005","2004","2006","2008","2021","2014","2018","2019","2015","2016","2014","2016","2008","1999","2005","1999","2009","1974","2000","2006","1988","2008","1986","1986","2009","2015","2012","2011","2010","2008","2006","2009","1973","1978","2000","1973","1976","1988","2003","1982","1984","1979","2012","2022","2011","2020","2016","2010","2014","2019","2012","2006","1972","1999","2008","2009","1983","1973","1986","1980","1978","1981","1987","1979","2018","2019","2016","2018","2013","2013","2015","2021","2017","2010","2011","2007","2001","1997","2008","1996","2000","1978","2009","1984","1983","1989","1990","2020","2013","2014","2022","2023","2007","1999","1983","1985","2009","1975","1990","1979","1978","2008","2018","2013","2023","2018","2023","2016","2013","2008","1981","1975","1980","2019","2015","2017","2017","2015","2018","2011","2006","2008","1984","2008","1983","1987","2021","2022","2014","2011","2011","2009","2006","2008","2007","1991","2023","2015","2014","2020","2022","2010","2021","2019","2011","2013","2009","2007","2009","2007","2003","1985","1988","2001","1985","1985","2017","2022","2014","2012","2016","2016","2019","2019","2010","2011","2008","1986","1985","2023","2021","2015","2012","2010","2019","2014","2015","1975","2003","2009","2006","1981","2005","2023","2016","2011","2015","2018","2017","2021","2013","2016","2009","2006","2005","1984","2015","2023","2013","2017","2021","2013","2018","2019","2017","2011","2015","1994","2009","2009","1987","1977","2014","2015","2019","2017","2016","2021","2014","2017","2014","2014","2017","2017","2015","2014","2007","1999","2015","2022","2011","2016","2015","2020","2022","2017","2018","2000","2009","2023","2022","2023","2010","2017","2018","2012","2016","2006","2020","2020","2017","2018","2015","2010","2020","2016","2017","2016","2015","2019","2021","2010","2008","2022","2015","2017","2015","2014","2000","2006","2023","2023","2010","2013","2022","2012","2011","2008","2018","2013","2007","2022","2016","2023","2012","2014","2012","2008","2009","2022","2014","2008","2001","2018","2017","2003","2018","2016","2012","2020","2014","2020","2011","2010","2009","2005","2005","2010","1982","2006","2006","2016","2016","2004","2017","2023","2008","2007","2018","2014","2016","2015","2020","2017","2011","2023","2016","2017","2008","2005","2004","2013","2008","2004","2010","2019","2018","2009","2006","2016","2006","2018","2019","2017","2018","2007","2015","2017","2006","2006","2007","2019","2018","2021","2022","2017","2017"],"y":[9.1999999999999993,8.9000000000000004,8.8000000000000007,8.8000000000000007,8.6999999999999993,8.6999999999999993,8.6999999999999993,8.6999999999999993,8.5999999999999996,8.5999999999999996,8.5999999999999996,8.5,8.5,8.5,8.4000000000000004,8.4000000000000004,8.4000000000000004,8.3000000000000007,8.3000000000000007,8.3000000000000007,8.3000000000000007,8.1999999999999993,8.1999999999999993,8.1999999999999993,8.1999999999999993,8.1999999999999993,8.1999999999999993,8.0999999999999996,8.0999999999999996,8.0999999999999996,8.0999999999999996,8.0999999999999996,8.0999999999999996,8.0999999999999996,8.0999999999999996,8,8,8,8,8,8,8,8,8,8,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.9000000000000004,7.7999999999999998,7.7999999999999998,7.7999999999999998,7.7999999999999998,7.7999999999999998,7.7999999999999998,7.7999999999999998,7.7999999999999998,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.7000000000000002,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5999999999999996,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.5,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.4000000000000004,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2999999999999998,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.2000000000000002,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7.0999999999999996,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.9000000000000004,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7999999999999998,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.7000000000000002,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5999999999999996,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.5,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.4000000000000004,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2999999999999998,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.2000000000000002,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6.0999999999999996,6,6,6,6,6,6,6,6,6,5.9000000000000004,5.9000000000000004,5.9000000000000004,5.9000000000000004,5.9000000000000004,5.9000000000000004,5.9000000000000004,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7999999999999998,5.7000000000000002,5.7000000000000002,5.7000000000000002,5.7000000000000002,5.7000000000000002,5.7000000000000002,5.7000000000000002,5.7000000000000002,5.7000000000000002,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5999999999999996,5.5,5.5,5.5,5.5,5.5,5.4000000000000004,5.4000000000000004,5.4000000000000004,5.4000000000000004,5.4000000000000004,5.4000000000000004,5.4000000000000004,5.2999999999999998,5.2999999999999998,5.2999999999999998,5.2999999999999998,5.2000000000000002,5.2000000000000002,5.2000000000000002,5.2000000000000002,5.0999999999999996,5.0999999999999996,5.0999999999999996,5,5,5,5,5,5,5,5,4.9000000000000004,4.9000000000000004,4.9000000000000004,4.9000000000000004,4.7999999999999998,4.7999999999999998,4.7999999999999998,4.7000000000000002,4.7000000000000002,4.5999999999999996,4.5999999999999996,4.5999999999999996,4.5999999999999996,4.5999999999999996,4.5,4.5,4.4000000000000004,4.4000000000000004,4.2999999999999998,4.2999999999999998,4.2999999999999998,4.2000000000000002,4.0999999999999996,4.0999999999999996,4.0999999999999996,3.8999999999999999,3.8999999999999999,3.8999999999999999,3.8999999999999999,3.7999999999999998,3.7999999999999998,3.7999999999999998,3.7000000000000002,3.7000000000000002,3.7000000000000002,3.7000000000000002,3.6000000000000001,3.5,3.3999999999999999,3.2999999999999998,3.2999999999999998,3.2999999999999998,3.2000000000000002,3.2000000000000002,3.1000000000000001,3,3,3,3,3,2.6000000000000001,2.3999999999999999,2.2000000000000002,2.2000000000000002,2,2,1.8999999999999999,1.7,1.6000000000000001,1.6000000000000001,1.5,1.5,1.3999999999999999,1.2,1.2,1.2,1,1],"boxpoints":"all","jitter":0.29999999999999999,"pointpos":-1.8,"marker":{"color":"#03A9F4","opacity":0.59999999999999998,"line":{"color":"rgba(31,119,180,1)"}},"type":"box","name":"#B3E5FC","line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>It reveals the ratings performance of movies over the years. Looking at the first quarter, we see that between 1960 and 1980, movie ratings were generally high and concentrated in a narrow range. This period is almost like the “golden age” of movies; there are almost no productions with low ratings. This suggests that a more consistent and high quality production standard was achieved in that period.</p>
<p>However, when we move from the 1980s to the 2000s, things change in the field. The distribution of ratings spreads over a wider range. While some productions rise to the top of the rating rankings, we notice that the number of low-rated films also increases. This may indicate a change in viewers’ evaluation criteria or an increase in the diversity of movie quality.</p>
<p>With the 2000s, a brand new game plan is emerging on the field. The range in ratings is getting wider. Especially low ratings (e.g.&nbsp;in the 3-4 band) are becoming more common. However, despite this, films with high ratings also remain in the race. In the period after 2010, the differences in quality have become much more pronounced. In some years, the wide range of ratings between 2 and 9 indicates a significant increase in the number of both low and high quality productions.</p>
</section>
<section id="d.-do-you-believe-there-is-a-relationship-between-the-number-of-votes-a-movie-received-and-its-rating-investigate-the-correlation-between-votes-and-ratings." class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> d.&nbsp;Do you believe there is a relationship between the number of votes a movie received and its rating? Investigate the correlation between Votes and Ratings.</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(final_movie_data<span class="sc">$</span>Votes, final_movie_data<span class="sc">$</span>Rating, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation between number of votes and rating: "</span>, correlation, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation between number of votes and rating:  0.1389151 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(final_movie_data, <span class="fu">aes</span>(<span class="at">x =</span> Votes, <span class="at">y =</span> Rating)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship Between Number of Votes and Rating"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of Votes"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rating"</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="websc_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It visualizes the relationship between the number of votes received by the films and their IMDb ratings. The correlation coefficient is <strong>0.139</strong>, indicating a weak positive relationship between the number of votes and the rating. This suggests that movies with more votes tend to receive higher ratings in general, but this relationship is not strongly correlated.</p>
<p>The graph shows that the majority of the films received less than 30,000 votes and that the ratings of these films are distributed in a wide range (between 2.5 and 8.5). This suggests that films with a low number of votes are subject to a greater diversity in audience evaluations. On the other hand, films with more than 50,000 votes generally have higher ratings, suggesting that popular films are evaluated more favorably by a wider audience.</p>
<p>The wide range of ratings for films with a low number of votes suggests that these films are often less well-known or appeal to a niche audience. These films are either highly appreciated by the audience or vice versa with low ratings. Films with a high number of votes, on the other hand, tend to have more consistently high ratings.</p>
<p>In conclusion, although there is a certain relationship between the number of votes and the rating, it is understood that the number of votes alone is not a sufficient criterion to predict the rating of a movie. In order to analyze this relationship more comprehensively, factors such as the genre of the films, the year of production or the audience should also be evaluated. The graph provides a useful visualization to understand the general trends and provides a basis for more detailed analysis.</p>
</section>
<section id="e.-do-you-believe-there-is-a-relationship-between-a-movies-duration-and-its-rating-investigate-the-correlation-between-duration-and-ratings." class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> e. Do you believe there is a relationship between a movie’s duration and its rating? Investigate the correlation between Duration and Ratings.</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>correlation_duration_rating <span class="ot">&lt;-</span> <span class="fu">cor</span>(final_movie_data<span class="sc">$</span>Duration, final_movie_data<span class="sc">$</span>Rating, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation between duration and rating: "</span>, correlation_duration_rating, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation between duration and rating:  0.02087384 </code></pre>
</div>
</div>
<p>The correlation coefficient of 0.0213 indicates that there is almost no relationship between movie duration and rating. This clearly shows that the length of a movie does not have a determining effect on its rating.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(final_movie_data, <span class="fu">aes</span>(<span class="at">x =</span> Duration, <span class="at">y =</span> Rating)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship Between Movie Duration and Rating"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Movie Duration (Minutes)"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rating"</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="websc_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It is noteworthy that the majority of the films are concentrated between 80-120 minutes. The ratings of films of these durations are distributed over a wide range (between 5 and 8), suggesting that standard-length films generally show a similar trend in audience evaluations. However, both shorter (less than 50 minutes) and longer (more than 150 minutes) films are underrepresented in the graph. The ratings of these films are also quite widely distributed, suggesting that the length of the film is not an influential factor on the rating.</p>
</section>
<section id="repeat-steps-1-and-2-for-a-different-advanced-imdb-search.-this-time-find-turkish-movies-that-are-in-the-top-1000-movies-on-imdb.-perform-similar-scraping-to-create-another-dataframe-with-only-the-columns-title-year." class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> 4. Repeat steps 1 and 2 for a different advanced IMDb search. This time, find Turkish movies that are in the top 1000 movies on IMDb. Perform similar scraping to create another DataFrame with only the columns: Title, Year.</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSelenium)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>rD <span class="ot">&lt;-</span> <span class="fu">rsDriver</span>(<span class="at">browser =</span> <span class="st">"firefox"</span>, <span class="at">port =</span> <span class="dv">4545</span>L, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>remDr <span class="ot">&lt;-</span> rD[[<span class="st">"client"</span>]]</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://m.imdb.com/search/title/?title_type=feature&amp;num_votes=2500,999999&amp;groups=top_1000&amp;country_of_origin=TR&amp;count=250"</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">navigate</span>(url)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>page_source <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">getPageSource</span>()[[<span class="dv">1</span>]]</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(page_source)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>title_names <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">"h3.ipc-title__text"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span>                       </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>                          </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split</span>(<span class="st">" "</span>, <span class="at">n =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>             </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(x) x[<span class="dv">2</span>]) <span class="sc">%&gt;%</span>          </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()                              </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">".sc-300a8231-6.dBUjvq.dli-title-metadata span:nth-child(1)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>movie_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Title =</span> title_names,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Year =</span> years,</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(movie_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      Title Year
1       7. Koğuştaki Mucize 2019
2                Kış Uykusu 2014
3                      Ayla 2017
4   Bir Zamanlar Anadolu'da 2011
5            Babam ve Oğlum 2005
6                  G.O.R.A. 2004
7               Ahlat Ağacı 2018
8                    Eşkıya 1996
9     Nefes: Vatan Sağolsun 2009
10                Vizontele 2001
11 Her Şey Çok Güzel Olacak 1998</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">close</span>()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>rD<span class="sc">$</span>server<span class="sc">$</span><span class="fu">stop</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(final_movie_data, movie_data,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Title"</span>, <span class="st">"Year"</span>), </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all  =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>ordered_df <span class="ot">&lt;-</span> merged_df[<span class="fu">order</span>(merged_df<span class="sc">$</span>Rank), ]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>ordered_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      Title Year Duration Rating Votes Rank
1       7. Koğuştaki Mucize 2019      132    8.2 58000   22
3                      Ayla 2017      125    8.2 45000   23
4            Babam ve Oğlum 2005      108    8.2 96000   27
6                    Eşkıya 1996      128    8.1 73000   28
8  Her Şey Çok Güzel Olacak 1998      107    8.1 29000   31
9                Kış Uykusu 2014      196    8.0 57000   36
2               Ahlat Ağacı 2018      188    8.0 29000   37
7                  G.O.R.A. 2004      127    8.0 68000   39
10    Nefes: Vatan Sağolsun 2009      128    8.0 36000   40
11                Vizontele 2001      110    8.0 40000   41
5   Bir Zamanlar Anadolu'da 2011      157    7.8 51000   59</code></pre>
</div>
</div>
<p>When we look at it, it is obvious that it is not the same as the other data that was taken, we can also see this with the rank we created before, these values were lower in our previous data set. I’m not sure if we can relate this to this, but in the old times, when not everyone had access to television, it was a socializing purpose for people, and the time spent on television was a reality like the Kemal Sunal situation mentioned above. I think people have that kind of tendency. The average user can make a ranking based on the rating and the number of votes given.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>